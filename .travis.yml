# ov50 Linux/OSX build - courtesy to https://github.com/seandepagnier
language: cpp
matrix:
  include:
    - env:
        - OCPN_TARGET=xenial
      dist: xenial
      compiler: gcc
      script:
        - sh ./ci/travis-build-debian.sh

    - env:
        - OCPN_TARGET=trusty
      dist: trusty
      compiler: gcc
      script:
        - sh ./ci/travis-build-debian.sh

    - env:
        - OCPN_TARGET=osx
      os: osx
      compiler: clang
      script:
        - bash ./ci/travis-build-osx.sh
        
script:
  - if [[ "${COVERITY_SCAN_BRANCH}" == 1 ]];
    then
      echo "Don't build on coverty_scan branch.";
      exit 0;
    fi
  - ls -l;

notifications:
  email: false
git:
  depth: 10
before_install:
- if [ "$CXX" = "g++" ]; then export CXX="g++-6" CC="gcc-6"; fi
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - gcc-6
    - g++-6
deploy:
- provider: releases
  api_key:
    secure: "fAXQOEZd83GYDVDw+KOHEJwKWAD/ILVlT9vWl6FNQkjltIBVp0PpbkgRr/fQcGrQno7UMUZdPm+OIbWAq+0d675SoeZ8NFjGd884SzjslWauB8kRG7iK72Y0EAYqRHl83XqdspuCcBE24fU95C87DbQdhp/zmKi+NB8n3m0X4ifw2G6CNpUdaj9Oxq7dDIQikUTynmmIlTMXtNLr8aQRBihLVpMoIuWLyjskyxPuRU+jFkM0xAeyqy246ZFg0eK2HTIqhlSA/HJHlPHF0gBDxnjca5ZIGYC7s5rr03ghSIMAr6nLHCmAelWPp3+znwTzJ5mGv+4vKwOvOi3EMpCDtsDbh0ybMkSr3tdJzJ9TEsgZ6MIqC2X9bwKtQcW/cmSeJmmpUVhaIZ7KjYS3cIxlQ+jU0aIZupsf0P73rovTfNWuC919H9Ggu/Mc3rELwBUZ1FctxDFZ13cM1gnpbAZXA0xZGGK0AV3Y9M1BQ/RBcnez2OT7DAwYofYe2VAnvMJbYkJUKVVMsKZqPF+9fXGYhtVTpKw3j89nE98xRkIKiWQBmUE6x5XPSgxsI1CaDBIuZiXDO/IMh2v3HGiFlOC8qAuV6Z1vdHbaIFtzPkVEZ1miMBbD3XPki3Crl4kVXtGrCPAl6uH3YVrats9CL6shfgwzsS52zBacQxQu7RCrT6U="
  file_glob: true
  file: "$TRAVIS_BUILD_DIR/build/*.{deb,rpm,dmg,txz,pkg,pkg.tar.xz}"
  skip_cleanup: true
  on:
    repo: mauroc/squiddio_pi
    tags: true
    all_branches: true
    
